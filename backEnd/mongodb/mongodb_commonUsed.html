<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MongoDB 常用语句 | 任振飞的博客</title>
    <meta name="description" content="Just Do it">
    
    
    <link rel="preload" href="/vuepress-bolg/assets/css/0.styles.8fb03ca1.css" as="style"><link rel="preload" href="/vuepress-bolg/assets/js/app.ea6c41f1.js" as="script"><link rel="preload" href="/vuepress-bolg/assets/js/7.f048c0a0.js" as="script"><link rel="prefetch" href="/vuepress-bolg/assets/js/10.5938ca84.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/11.eebccd28.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/12.9049cd61.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/13.92bff893.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/14.36faef53.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/15.028284c5.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/16.4ac1473a.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/17.654aef9d.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/18.7aa81695.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/19.936cc10b.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/2.2a0d8cfe.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/20.5bbc223e.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/21.c7b2fdc7.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/22.ec4d39b2.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/3.e60e7ae5.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/4.6e7778de.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/5.eff4ac38.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/6.67474d49.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/8.9a8a1911.js"><link rel="prefetch" href="/vuepress-bolg/assets/js/9.3363a5e6.js">
    <link rel="stylesheet" href="/vuepress-bolg/assets/css/0.styles.8fb03ca1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-bolg/" class="home-link router-link-active"><!----> <span class="site-name">任振飞的博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-bolg/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuepress-bolg/frontEnd/jsCommon/array.html" class="nav-link">js常用</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/html/html5_webWorker.html" class="nav-link">html</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/css/css_commonUsed.html" class="nav-link">css</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/javascript/closure.html" class="nav-link">javascript</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/vue/vue_unkown.html" class="nav-link">vue</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/webpack/webpack_learn.html" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/npm/npm.html" class="nav-link">npm</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/git/git.html" class="nav-link">git</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/node/node_question.html" class="nav-link">node</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/express/express_middleWare.html" class="nav-link">express</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/koa/koa_learn.html" class="nav-link">koa</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/mongodb/mongodb_commonUsed.html" class="nav-link router-link-exact-active router-link-active">mongodb</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/nginx/nginx_learn.html" class="nav-link">nginx</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/jsp/jsp_commonUsed.html" class="nav-link">jsp</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/renzhenfei666/vuepress-bolg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress-bolg/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuepress-bolg/frontEnd/jsCommon/array.html" class="nav-link">js常用</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/html/html5_webWorker.html" class="nav-link">html</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/css/css_commonUsed.html" class="nav-link">css</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/javascript/closure.html" class="nav-link">javascript</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/vue/vue_unkown.html" class="nav-link">vue</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/webpack/webpack_learn.html" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/npm/npm.html" class="nav-link">npm</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/frontEnd/git/git.html" class="nav-link">git</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/node/node_question.html" class="nav-link">node</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/express/express_middleWare.html" class="nav-link">express</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/koa/koa_learn.html" class="nav-link">koa</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/mongodb/mongodb_commonUsed.html" class="nav-link router-link-exact-active router-link-active">mongodb</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/nginx/nginx_learn.html" class="nav-link">nginx</a></li><li class="dropdown-item"><!----> <a href="/vuepress-bolg/backEnd/jsp/jsp_commonUsed.html" class="nav-link">jsp</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/renzhenfei666/vuepress-bolg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vuepress-bolg/backEnd/mongodb/mongodb_commonUsed.html" class="active sidebar-link">MongoDB 常用语句</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-bolg/backEnd/mongodb/mongodb_commonUsed.html#_1、查询-find" class="sidebar-link">1、查询(find)</a></li><li class="sidebar-sub-header"><a href="/vuepress-bolg/backEnd/mongodb/mongodb_commonUsed.html#_2、创建（insert）" class="sidebar-link">2、创建（insert）</a></li><li class="sidebar-sub-header"><a href="/vuepress-bolg/backEnd/mongodb/mongodb_commonUsed.html#_3、更新（update）" class="sidebar-link">3、更新（update）</a></li><li class="sidebar-sub-header"><a href="/vuepress-bolg/backEnd/mongodb/mongodb_commonUsed.html#_4、删除（remove）" class="sidebar-link">4、删除（remove）</a></li></ul></li></ul> </div> <div class="page"> <div class="content"><h1 id="mongodb-常用语句"><a href="#mongodb-常用语句" aria-hidden="true" class="header-anchor">#</a> MongoDB 常用语句</h1> <h2 id="_1、查询-find"><a href="#_1、查询-find" aria-hidden="true" class="header-anchor">#</a> 1、查询(find)</h2> <p>（1）查询所有结果</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from articledb.article.find()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（2）指定返回哪些键</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select title, author from articledb.article.find({}, {&quot;title&quot;: 1, &quot;author&quot;: 1})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（3）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>where
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>条件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article where title = &quot;mongodb&quot;db.article.find({&quot;title&quot;: &quot;mongodb&quot;})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（4）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>and
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>条件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article where title = &quot;mongodb&quot; and author = &quot;god&quot;db.article.find({&quot;title&quot;: &quot;mongodb&quot;, &quot;author&quot;: &quot;god&quot;})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（5）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>or
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>条件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article where title = &quot;mongodb&quot; or author = &quot;god&quot;db.article.find({&quot;$or&quot;: [{&quot;title&quot;: &quot;mongodb&quot;}, {&quot;author&quot;: &quot;god&quot;}]})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（6）比较条件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article where read &gt;= 100;db.article.find({&quot;read&quot;: {&quot;$gt&quot;: 100}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>$gt(&gt;)、</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$gte
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>(&gt;=)、</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$lt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>(&lt;)、</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$lte
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>(&lt;=)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article where read &gt;= 100 and read &lt;= 200db.article.find({&quot;read&quot;: {&quot;$gte&quot;: 100, &quot;lte&quot;: 200}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（7）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>in
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>条件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article where author in (&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)db.article.find({&quot;author&quot;: {&quot;$in&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（8）like</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article where title like &quot;%mongodb%&quot;db.article.find({&quot;title&quot;: /mongodb/})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（9）count</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select count(*) from articledb.article.count()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（10）不等于</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article where author != &quot;a&quot;db.article.find({ &quot;author&quot;: { &quot;$ne&quot;: &quot;a&quot; }})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（11）排序</p> <p>升序：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article where type = &quot;mongodb&quot; order by read descdb.article.find({&quot;type&quot;: &quot;mongodb&quot;}).sort({&quot;read&quot;: -1})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>降序：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article where type = &quot;mongodb&quot; order by read asc
db.article.find({&quot;type&quot;: &quot;mongodb&quot;}).sort({&quot;read&quot;: 1})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>findOne()：除了只返回一个查询结果外，使用方法与</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>一样。</p> <h2 id="_2、创建（insert）"><a href="#_2、创建（insert）" aria-hidden="true" class="header-anchor">#</a> 2、创建（insert）</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>insert into article(title, author, content) values(&quot;mongodb&quot;, &quot;tg&quot;, &quot;haha&quot;)db.article.insert({&quot;title&quot;: &quot;mongodb&quot;, &quot;author&quot;: &quot;tg&quot;, &quot;content&quot;: &quot;haha&quot;})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_3、更新（update）"><a href="#_3、更新（update）" aria-hidden="true" class="header-anchor">#</a> 3、更新（update）</h2> <p>（1）update()</p> <p>语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.collecion.update(query, update[, options] )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><code>query</code> : 必选，查询条件，类似find中的查询条件。</li> <li><code>update</code> : 必选，update的对象和一些更新的操作符（如$,$inc...）等</li> <li><code>options</code>：可选，一些更新配置的对象。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>upsert
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>：可选，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>multi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>：可选，mongodb 默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>writeConcern
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>：可选，抛出异常的级别。</p> <p>简单更新：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>update article set title = &quot;mongodb&quot; where read &gt; 100db.article.update({&quot;read&quot;: {&quot;$gt&quot;: 100}}, {&quot;$set&quot;: { &quot;title&quot;: &quot;mongodb&quot;}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（2）save()</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.save({_id: 123, title: &quot;mongodb&quot;})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行上面的语句，如果集合中已经存在一个_id为123的文档，则更新对应字段;否则插入。</p> <p>注：如果更新对象不存在_id，系统会自动生成并作为新的文档插入。</p> <p>（3）更新操作符</p> <p>MongoDB提供一些强大的更新操作符。</p> <p>更新特定字段（</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$set
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>update game set count = 10000 where _id = 123db.game.update({&quot;_id&quot;: 123}, { &quot;$set&quot;: {&quot;count&quot;: 10000}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>删除特定字段（</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$unset
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.game.update({&quot;_id&quot;:123}, {&quot;$unset&quot;: {&quot;author&quot;:1}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$unset
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>指定字段的值只需是任意合法值即可。</p> <p>递增或递减（</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$inc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.game.update({&quot;_id&quot;: 123}, { &quot;$inc&quot;: {&quot;count&quot;: 10}}) // 每次count都加10
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注意：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$inc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>对应的字段必须是数字，而且递增或递减的值也必须是数字。</p> <p>数组追加（</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$push
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.game.update({&quot;_id&quot;: 123}, { &quot;$push&quot;: {&quot;score&quot;: 123}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>还可以一次追加多个元素：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.game.update({&quot;_id&quot;: 123}, {&quot;$push&quot;: {&quot;score&quot;: [12,123]}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注：追加字段必须是数组。如果数组字段不存在，则自动新增，然后追加。</p> <p>一次追加多个元素（</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$pushAll
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.game.update({&quot;_id&quot;: 123}, {&quot;$pushAll&quot;: {&quot;score&quot;: [12,123]}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>追加不重复元素（</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$addToSet
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>）： $addToSet类似集合Set，只有当这个值不在元素内时才增加：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.game.update({&quot;_id&quot;: 123}, {&quot;$addToSet&quot;: {&quot;score&quot;: 123}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>删除元素（</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$pop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.game.update({&quot;_id&quot;: 123}, {&quot;$pop&quot;: {&quot;score&quot;: 1}})  // 删除最后一个元素db.game.update({&quot;_id&quot;: 123}, {&quot;$pop&quot;: {&quot;score&quot;: -1}})  // 删除第一个元素
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$pop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>每次只能删除数组中的一个元素，</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>表示删除最后一个，</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>-1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>表示删除第一个。</p> <p>删除特定元素（</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$pull
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.game.update({&quot;_id&quot;: 123}, {&quot;$pull&quot;: {&quot;score&quot;: 123}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的语句表示删除数组score内值等于123的元素。</p> <p>删除多个特定元素（</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$pullAll
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.game.update({&quot;_id&quot;: 123}, {&quot;$pullAll&quot;: {score: [123,12]}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的语句表示删除数组内值等于123或12的元素。</p> <p>更新嵌套数组的值：</p> <p>使用数组下标（从</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>开始）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{  address: [{place: &quot;nanji&quot;, tel: 123}, {place: &quot;dongbei&quot;, tel: 321}]}db.game.update({&quot;_id&quot;: 123}, {&quot;$set&quot;: {&quot;address.0.tel&quot;: 213}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果你不知道要更新数组哪项，我们可以使用</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>操作符（</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>表示自身，也就是按查询条件找出的数组里面的项自身，而且只会应用找到的第一条数组项）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.game.update({&quot;address.place&quot;: &quot;nanji&quot;}, {&quot;$set&quot;: {&quot;address.$.tel&quot;: 123}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在上面的语句中，</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>就是查询条件{&quot;address.place&quot;: &quot;nanji&quot;}的查询结果，也就是{place: &quot;nanji&quot;, tel: 123}，所以{&quot;address.$.tel&quot;: 123}也就是{&quot;address.{place: &quot;nanji&quot;, tel: 123}.tel&quot;: 123}</p> <h2 id="_4、删除（remove）"><a href="#_4、删除（remove）" aria-hidden="true" class="header-anchor">#</a> 4、删除（remove）</h2> <p>删除所有文档：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>delete from articledb.article.remove()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>删除指定文档：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>delete from article where title = &quot;mongodb&quot;db.article.remove({title: &quot;mongodb&quot;})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>MongoDB特有的语句</strong></p> <p><strong>1. 数组查询</strong></p> <p>（1）数组的普通查询</p> <p>假如type是[&quot;mongodb&quot;, &quot;javascript&quot;]：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find({&quot;type&quot;: &quot;mongodb&quot;})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的语句可以匹配成功。</p> <p>（2）多个元素的查询</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find({&quot;type&quot;: {&quot;$all&quot;: [&quot;mongodb&quot;, &quot;javascript&quot;]}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>只有type数组同时存在mongodb和javascript才会匹配。</p> <p>（3）限制数组长度查询</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find({&quot;type&quot;: {&quot;$size&quot;: 2}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>只有数组的长度是2才会匹配</p> <p>注：type必须是数组</p> <p>（4）返回特定数量</p> <p>当<code>$slice</code>的参数是一个时，表示返回的数量;当是一个数组时，第一个参数表示偏移量，第二个表示返回的数量：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find({&quot;type&quot;: {&quot;$slice&quot;: 1}}) // 返回第1个db.article.find({&quot;type&quot;: {&quot;$slice&quot;: -1}})  // 返回最后一个db.article.find({&quot;type&quot;: {&quot;$slice&quot;: [20, 10]}})  // 从第21个开始，返回10个，也就是21～30
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注：<code>$slice</code>针对的是数组</p> <p>（5）元素匹配</p> <p>如果文档中有一个字段的值是数组，可以使用<code>$elemMatch</code>来匹配数组内的元素：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{  kown: [{ a: 2, b: 4}, 10, { a: 4}, {b:10}]}db.article.find({&quot;kown&quot;: { &quot;$elemMatch&quot;: {a: 1, b: {&quot;$gt&quot;: 2}}}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>只有a=1且b&gt;2才会匹配。</p> <p><strong>2. 取模（$mod）</strong></p> <p>比如我们要匹配 read % 5 == 1：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find({&quot;read&quot;: {$mod: [5, 1]}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>3. 是否存在（$exists)</strong></p> <p>如果我们要判断love字段是否存在，可以这样：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find({&quot;love&quot;: {&quot;$exists&quot;: true}})  // 如果存在字段love，就返回
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们也可以判断不存在：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find({&quot;love&quot;: {&quot;$exists&quot;: false}}) // 如果不存在字段love，就返回
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>4. 正则表达式</strong></p> <p>mongodb支持正则表达式，使用方法与正则字面量一样：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find({&quot;title&quot;: /mongodb/i})  // i是忽略大小写
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>5. 类型查询</strong></p> <p>我们可以根据字段类型来返回数据：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find({&quot;comments&quot;: {&quot;$type&quot;: 4}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>只有当comments的类型是数组才匹配</p> <p>注：更多类型的数值可以参考这里：<a href="https://link.juejin.im/?target=https%3A%2F%2Fdocs.mongodb.com%2Fmanual%2Freference%2Foperator%2Fquery%2Ftype%2F" target="_blank" rel="noopener noreferrer">mongodb $type<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><strong>6. 内嵌文档</strong></p> <p>mongodb是允许内嵌文档的，而且要查询内嵌文档也很简单（使用点语法）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{  address: { name: &quot;nanji&quot; }}db.article.find({&quot;address.name&quot;: &quot;nanji&quot;})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的语句是查询comments中的author。</p> <p>数组也可以采取点语法:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{  comments: [{title: &quot;mongodb&quot;}, {title: &quot;javascript&quot;}]}db.article.find({&quot;comments.title&quot;: &quot;mongodb&quot;})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>7. 取反</strong></p> <p>$not是元语句，即可以用在任何其他条件之上：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find({&quot;author&quot;: {&quot;$not&quot;: /mongodb/i}})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>只要使用<code>$not</code>操作符，就表示取反。</p> <p><strong>MongoDB常用方法</strong></p> <p><strong>1. 控制返回数量（limit）</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find().limit(10)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回10条数据</p> <p><strong>2. 略过数量</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find().skip(5)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>略过前5条数据，也就是从第6条开始返回。</p> <p>可以结合<code>limit()</code>和<code>skip()</code>来达到分页效果：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select * from article limit 10, 20db.article.find().skip(10).limit(20) 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>3. 统计</strong></p> <p>返回匹配数据的长度：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find().count()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>4. 格式化</strong></p> <p>pretty()方法可以以格式化的方式显示所有文档：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.find().pretty()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>5. 删除集合</strong></p> <p>当你要删除一个集合中的所有文档时，直接删除一个集合效率会更高：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.article.drop()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/vuepress-bolg/assets/js/app.ea6c41f1.js" defer></script><script src="/vuepress-bolg/assets/js/7.f048c0a0.js" defer></script>
  </body>
</html>
